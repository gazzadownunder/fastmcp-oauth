{
  "trustedIDPs": [
    {
      "issuer": "http://localhost:8080/realms/mcp_security",
      "discoveryUrl": "http://localhost:8080/realms/mcp_security/.well-known/openid-configuration",
      "jwksUri": "http://localhost:8080/realms/mcp_security/protocol/openid-connect/certs",
      "audience": "mcp-oauth",
      "algorithms": ["RS256"],
      "claimMappings": {
        "legacyUsername": "legacy_name",
        "roles": "roles",
        "scopes": "scope",
        "userId": "sub",
        "username": "preferred_username"
      },
      "roleMappings": {
        "admin": ["admin", "administrator", "realm-admin", "mcp-oauth-admin"],
        "user": ["user", "authenticated"],
        "write": ["mcp-oauth-write"],
        "read": ["mcp-oauth-read"],
        "guest": ["guest", "anonymous"],
        "defaultRole": "guest"
      },
      "security": {
        "clockTolerance": 60,
        "maxTokenAge": 3600,
        "requireNbf": false
      }
    }
  ],
  "rateLimiting": {
    "maxRequests": 1000,
    "windowMs": 900000
  },
  "audit": {
    "logAllAttempts": true,
    "logFailedAttempts": true,
    "retentionDays": 7
  },
  "permissions": {
    "adminPermissions": ["read", "write", "delete", "admin", "sql:query", "sql:procedure", "sql:function"],
    "userPermissions": ["read", "write", "sql:query"],
    "guestPermissions": ["read"],
    "customPermissions": {
      "write": ["sql:query", "sql:procedure"],
      "read": ["sql:query"]
    }
  }
}