{
  "auth": {
    "trustedIDPs": [
      {
        "name": "requestor-jwt",
        "issuer": "http://localhost:8080/realms/mcp_security",
        "discoveryUrl": "http://localhost:8080/realms/mcp_security/.well-known/openid-configuration",
        "jwksUri": "http://localhost:8080/realms/mcp_security/protocol/openid-connect/certs",
        "audience": "mcp-oauth",
        "algorithms": ["RS256"],
        "claimMappings": {
          "legacyUsername": "legacy_name",
          "roles": "roles",
          "scopes": "scope",
          "userId": "sub",
          "username": "preferred_username"
        },
        "roleMappings": {
          "admin": ["admin", "administrator", "realm-admin", "mcp-oauth-admin"],
          "user": ["user", "authenticated"],
          "write": ["mcp-oauth-write"],
          "read": ["mcp-oauth-read"],
          "guest": ["guest", "anonymous"],
          "defaultRole": "guest"
        },
        "security": {
          "clockTolerance": 60,
          "maxTokenAge": 3600,
          "requireNbf": false
        }
      },
      {
        "name": "sql-delegation-te-jwt",
        "issuer": "http://localhost:8080/realms/mcp_security",
        "discoveryUrl": "http://localhost:8080/realms/mcp_security/.well-known/openid-configuration",
        "jwksUri": "http://localhost:8080/realms/mcp_security/protocol/openid-connect/certs",
        "audience": "urn:sql:database",
        "algorithms": ["RS256"],
        "claimMappings": {
          "legacyUsername": "legacy_name",
          "roles": "roles",
          "scopes": "scope",
          "userId": "sub",
          "username": "preferred_username"
        },
        "roleMappings": {
          "admin": ["admin"],
          "user": ["user"],
          "guest": ["guest"],
          "defaultRole": "guest"
        },
        "security": {
          "clockTolerance": 60,
          "maxTokenAge": 3600,
          "requireNbf": false
        }
      }
    ],
    "rateLimiting": {
      "enabled": true,
      "maxRequests": 1000,
      "windowMs": 900000
    },
    "audit": {
      "enabled": true,
      "logAllAttempts": true,
      "retentionDays": 90
    }
  },
  "delegation": {
    "tokenExchange": {
      "tokenEndpoint": "http://localhost:8080/realms/mcp_security/protocol/openid-connect/token",
      "clientId": "mcp-oauth",
      "clientSecret": "9DQjCpm4D9wbzXxHa1ki51PhBbyxOXrg",
      "audience": "mcp-oauth",
      "defaultScope": "openid profile email",
      "cache": {
        "enabled": true,
        "ttlSeconds": 60,
        "sessionTimeoutMs": 900000,
        "maxEntriesPerSession": 10,
        "maxTotalEntries": 1000
      }
    },
    "modules": {
      "sql": {
        "server": "localhost",
        "database": "test_db",
        "options": {
          "trustedConnection": true,
          "encrypt": true,
          "trustServerCertificate": true
        }
      }
    }
  },
  "mcp": {
    "serverName": "MCP OAuth Phase 3 Test Server (Cache Enabled)",
    "version": "3.0.0",
    "transport": "http-stream",
    "port": 3000,
    "enabledTools": {
      "sql-delegate": true,
      "health-check": true,
      "user-info": true,
      "audit-log": true
    }
  }
}
